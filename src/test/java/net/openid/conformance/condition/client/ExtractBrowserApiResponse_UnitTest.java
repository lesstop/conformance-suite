package net.openid.conformance.condition.client;

import net.openid.conformance.condition.Condition.ConditionResult;
import net.openid.conformance.logging.TestInstanceEventLog;
import net.openid.conformance.testmodule.Environment;
import org.junit.jupiter.api.BeforeEach;
import org.junit.jupiter.api.Test;
import org.junit.jupiter.api.extension.ExtendWith;
import org.mockito.Mock;
import org.mockito.Spy;
import org.mockito.junit.jupiter.MockitoExtension;

import static org.assertj.core.api.Assertions.assertThat;

@ExtendWith(MockitoExtension.class)
public class ExtractBrowserApiResponse_UnitTest {

	@Spy
	private Environment env = new Environment();

	@Mock
	private TestInstanceEventLog eventLog;

	private String goodResponse;

	private ExtractBrowserApiResponse cond;


	@BeforeEach
	public void setUp() throws Exception {

		cond = new ExtractBrowserApiResponse();
		cond.setProperties("UNIT-TEST", eventLog, ConditionResult.INFO);

		// response captured from google wallet; note that it's wrong...

		goodResponse = "{\"data\":\"{\\n \\\"vp_token\\\": \\\"o2d2ZXJzaW9uYzEuMGlkb2N1bWVudHOBo2dkb2NUeXBldW9yZy5pc28uMTgwMTMuNS4xLm1ETGxpc3N1ZXJTaWduZWSiam5hbWVTcGFjZXOhcW9yZy5pc28uMTgwMTMuNS4xhdgYWFmkaGRpZ2VzdElEAmZyYW5kb21QnXgX0XzS2XzIrV1S8CngE3FlbGVtZW50SWRlbnRpZmllcmtmYW1pbHlfbmFtZWxlbGVtZW50VmFsdWVqTXVzdGVybWFubtgYWFSkaGRpZ2VzdElEGD5mcmFuZG9tUD0pd9hEq6mR1YVljYuyX2BxZWxlbWVudElkZW50aWZpZXJqZ2l2ZW5fbmFtZWxlbGVtZW50VmFsdWVlRXJpa2HYGFhcpGhkaWdlc3RJRBgiZnJhbmRvbVB9e2wugapy4VPj55D7KsyNcWVsZW1lbnRJZGVudGlmaWVyamJpcnRoX2RhdGVsZWxlbWVudFZhbHVl2QPsajE5NzEtMDktMDHYGFkan6RoZGlnZXN0SUQYM2ZyYW5kb21QD9X6SjQS72UIb3NJcaW713FlbGVtZW50SWRlbnRpZmllcmhwb3J0cmFpdGxlbGVtZW50VmFsdWVZGlD_2P_gABBKRklGAAEBAAABAAEAAP_iAihJQ0NfUFJPRklMRQABAQAAAhgAAAAAAhAAAG1udHJSR0IgWFlaIAAAAAAAAAAAAAAAAGFjc3AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAD21gABAAAAANMtAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACWRlc2MAAADwAAAAdHJYWVoAAAFkAAAAFGdYWVoAAAF4AAAAFGJYWVoAAAGMAAAAFHJUUkMAAAGgAAAAKGdUUkMAAAGgAAAAKGJUUkMAAAGgAAAAKHd0cHQAAAHIAAAAFGNwcnQAAAHcAAAAPG1sdWMAAAAAAAAAAQAAAAxlblVTAAAAWAAAABwAcwBSAEcAQgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAWFlaIAAAAAAAAG-iAAA49QAAA5BYWVogAAAAAAAAYpkAALeFAAAY2lhZWiAAAAAAAAAkoAAAD4QAALbPcGFyYQAAAAAABAAAAAJmZgAA8qcAAA1ZAAAT0AAAClsAAAAAAAAAAFhZWiAAAAAAAAD21gABAAAAANMtbWx1YwAAAAAAAAABAAAADGVuVVMAAAAgAAAAHABHAG8AbwBnAGwAZQAgAEkAbgBjAC4AIAAyADAAMQA2_9sAQwAQCwwODAoQDg0OEhEQExgoGhgWFhgxIyUdKDozPTw5Mzg3QEhcTkBEV0U3OFBtUVdfYmdoZz5NcXlwZHhcZWdj_9sAQwEREhIYFRgvGhovY0I4QmNjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2Nj_8AAEQgBDADSAwEiAAIRAQMRAf_EABoAAAIDAQEAAAAAAAAAAAAAAAMEAQIFAAb_xAA5EAABBAEDAgQFAgQEBwEAAAABAAIDEQQSITEFQRMiUWEGMnGBkRQjM0KxwRVDUqEkJlNiktHhcv_EABgBAAMBAQAAAAAAAAAAAAAAAAABAgME_8QAIREBAQACAwEBAAIDAAAAAAAAAAECERIhMUEDE2EiMlH_2gAMAwEAAhEDEQA_APRv-cqqu824qqtk5QuXFMO7KFK4pBBKi75U8lZ_UOosxga3IU5ZaXjhyHyslkDDrdS89ndYa4lkW59UllZkuY82TSB4FN1cDuSstb7rbeuo52VI87mh7KvzeqrQ_kG3qp1EfLuVaexWsdp-bb0UPB0aSQhOL6suAQi6-5KNC1ABZIdkyACKvf0CV1Ei0SOTSbIsp0oaZTd6ukaPLDOW0hxyAt3bSvpjcoWehkZMNvwiPx6GzVnxsLHAsctCHM20yJeGo0mMgVSegm23QpImzMth3S7C6J2lyA3IZtY0g7oyxosgsdstWGYSsDhz3WmGW-mH6Ya7EKjupO_C6lqycuXbrkAd_wA5UKXi3lRRUqcoK7upQEdlBPcn8LtyaAVMl4hj3O6nLLUXhhcqWzsoQxk3S8rPK_LnIva16DP6P1HNwv1cL4vCLC8t1HUR9K_usb9rExQ6rceAsp_2ujrwF7WYzLdXsPVLASZbtUnliHZTHHJlTeJKfL6Ldb8O5s3ThmNdCyDQZNLnHUW8-iaaxCA4hjB5QukayEb7uPATJLWQh7Rz8oTuL8IdVzWeNL4WPrFhshOofYBE7F6ebkkL38rhvsFv5nwf1PBjMtR5Mbdz4RNgfQj-iw5i2MU35lp_SP7Uca2pc03sn-kdC6h1ck4sQ8IGjK800H09_staT4E6nEzXHNjSO_0hxB-1hBbedbNJGdnV7Ircx7fmY1491ebDlje6HIjdFPH8zXDdKta5h0ndLqq7h6LKB8zWnbkJuJ0eQ22nf2WXEHGQCK_Eug0Dclenw_hPqUjRPIYcZ7h8rnEn70FFipS0JfFzuE1pbO3cbq-Z03LwADlMaYya1xm2_wDxBaCxwI4UeL9VdCW7fgo2HO6CWnfKeUw0Ne0IUsSZWbjS1DkcFSDaUxJCB4bvsU5wt8buOXLHVRa5TQ9FypA7j5iqgilLvmKjZJSp9lwBdsFJ3OxR2NDG2eUsstRWOPKqO0wRlxO6xOo5Bcxzt67J7LlMjtINhKeAJ5A0_Kzcrlt5V2THjG503KbjdI6YJOJi2Oz2JBI_3FfdeJ6x09-N12fFIIiB1x__AJPH44-y9J8Qhw-FcV0btLmSsc0jsRaH8QNGd0zD6swAOaAySuwP_p39VrfGM9YuFh_qsyDEYPndRPoO5_C9plTxvw-o40QAbjQlhrsSwmvxSxvhyKPFhyuqzfJEwhv9T_YK_RC-XoXVp5f4kxke76lqMfDy9Y3wyyPI61iGatLQSwHu4C__AL9kL4tfm5XxBNjTPkbAzT4UdkNIrn33tI43iiSKSBxY-KnMI5BXrGdaxsnHa3rWGDp_zWNsfX1H2RL0Mp3tkdE6h_gWQwzzvGI8EPabcBtsQPqsjPjxep_ErmdNcTBlStDfKRpJq9j72V6XL-H8HrMJyOjZwc5o_hudY-nqPusfoGKcf4ixGSsLJI5NLmnsaKcui1K1Pi3qL-lRY3RemOMDRHqe5hpwbwBfvRJXmIcjLwZ2zY-VKyS7vUTf1HdbXxdHr-JpCf8ApMpZz4RRsfKAi3RzHceh-IQ3qnw5i9aYwNnioPruL0kfndeYmhEjbbsaterx2_8AIOSDxTq_8l57GZqx2g8hK0Yz4joObi9O6i3Ly4pJBG00GAEh3ruR7qvVMt_XOoTTyuf4er9ljj8je23FrpYG6tQFWtHpTuiwQO_xOKV82s0Waq00PQ-tolO467avw86SX4Xz4sx5dFGHBjnHgab59jus3Dd4kDdXNLW6u05_QQeiyxjBZvNExpDiBuf_AGQsnHoRtczjupzoxmzDHmN-g8HumdiKKA5vix2OQqwTV5XKVi0WOB7JxjgW2N0v5XDZTG_Q6ncLTG6ZZ47hrZcqavouW3KOfjTL_mNqv1Vn_MVzRZ90jkXijsglUy5NI0tKYc4Rx78pJ9uNkLnzy26vzx0VkGiMu5ceApkZ-mw6HzuRoI_EyLIsNU5bC94pQ1V6m3V8KYgd_qYrdHazIxcnpsp8krC5vt2P9iqZIypsSPFcIxCwgggHVt91VjZMeVk8JHiN4vg_Vacu2cwurFetj9F0rC6QwgvfTpSO4G5_Lv6I_SmeH8P9Rb30vv8A8EjM2bJznZeUWmQgNAaKAA9FZmVlw482PA2Ixy2Hl4JO4rbdHKbP-O8Qfh3DxppGR5IJD2-Tet0LrEE2JO-CSNzYtR0PrZw7bpgQCDFawnzdiFaPr3U8ZmlwiyG9vEFO_IS3L1T1lvcLfDOHMetRTwNcImA-I4cEVx-aVesTtZ8VTZOPv4L2E13cALH9k4_rPVs1hYwRY0ZG7owS78lIjFEMZAFk8k90XKSagmFuW61PiHB_XGDquG0ysMYa8N3Ncg19zax4cZ-S98cMbnvdtQC0cSbN6fGHYzxpO5jeLaUaTr3VZGubHDjxn_VRP90-r2UmWPUR1wN6f0DG6QxwdNLRfXoDZP52WLixaQG-6fixXyPdlZEjpZ38uchtj0T6T3KWWW1YY69E6fgQZuf-myHvYC0lpaQCT6b-1pLOw3YWbLjytcGtcdDnfzN7FaE8XmY9ri117EGiCmG9c6lEzRJFBPp4c4EH71sia0VmUu4N8PM_RdMzcqcaIHNsau9A2f8AdYnTrGOzV3CZzMzP6rTMp7GQXfhRigfr6qY4w2PT3RlZrRY43e6vEadpCpPHodrHBU6tJCYeBJFXslAHGQ5u3KJViu6TjJa_SU4039U4VcuVtQXKtk0H7k2rxigCVQ_ObVzelXnemOE3USHUfZBlcGsJRjxslZvNTR6rnrqxMYTKiLyPmUhniZNV5RyjwNDIm32C5jdDXvPLtgqLasjdTth5UvKyinWt0xWUpO8bn14SqseyMo7BEjiDRqdwArRR-JINtl2Y4Mb4bOe6Xi730SlcZX-yXlILw0DhMSkQM3-YoGEwzz2Ulf2ejj8PHGyVk80gaFpZIDI6vgJPCjEk_iH5Qn9LHzY0jOG-yrjsvxfomJgBqcfsl8d4t5vYp_SngsMdxCvVI5ArK27LVxG_sfe1lZVeK490Up6Yc3XGD7Whllg16LoH3E2zwrxup5CAA1u1omkE8LgN3BEZxaCpKYU4EeqajNsH0QsoVvSLj7sFpppbIjIdqCLGdTAe6NKwOYUrCCCQmkff0XK33XIJp15ySr8qDyVNU21WVRhNBuIDSgMbqePqizkNabQcXzSrP62-NEjygKHjU5rewVnDcITpNBPqmScmWgGjuknm3AfYKXygvtx2CrjOM0pkd8jVPrSTjDbWiKPflJSkN1Sycdk1PIBuT5RuVhZfUGzv0t47BFGIc73TPJPC1ekQBjC8jlZkLdR25W7i1HjgJTpefmi2Y7US1WhYIYBQ3KE9xdMSUZjjI4Adtk4V6gWc4tjaL3I4SmPeqk1nNL5z6NCXh8pRfTx8auL_AARXosbL2ldt3WljzNEdXSQyXMde_dNE6oUb9MY9LRw4F7XDuki4NaWk7IkD9TavhI7Dh_inbkK0JB2VNVkFVjcRIQUJWyhbSog-QeyvPvH_AFQ8ejYB7KkmHA6SElu2b6p8eZoSkzaf7oJZcotcgabTh5irO-UAKDWoqx9U6jEhmPqgpwd5qA4QMt1yn0CY6aeT6qJ61vjQeO54SGRJXHzO4T0poUeFnHz5I9ACnRhAhA4nc_VFtsLdqoblLZ2UYNm7lIuhzM9pc-TwoxzXdEly6is7MZumJ5WzhwMgF-6BFhRN-VwP3WVPBHGTJJO5kYNWTyi4zZWPY6OQvjf8pT42Ix_SbbkOPpIpOPsR6QkMack0_lPtdexUtqQe1_iWEWElhu90yYhRJCAWi9kvF73A5XWSR3QATq2V53aAaSjZ6JLuEJ6huGM-qBNivf8AK6t0IZ9khvCVk6nMLEcZdXKubZXKQwcGQA6nXaDUmM-yLCFH1h5dUo0n3TseRHOKJG_CLv6cuOXg8EzJGggq7tsgehCzpbxX6o-CdwtFrxKIpAoFhhwuM7cBLYu7z7pp_wAppKYhHjjflUin4hcZHoUDIbumox8yXyGlUn6X39Vyra5Sb0BH7hVXvpXcac4pWZ9bp1OMIZB_dkv1TfTjbmgJSflx9Ux06_EFKJ61s_xPZLqjcUgySpr9kzmOOgt9Sl2RgNBPKL6vCdBS47ZXl53Pol_38YutuuJ2xrkLQ0hSGtIIVY3QynKarzOa9k0Ygkic6NriRtuUbEcB4Y0lkUXAWu_HZZND8JSSFrN1XNE_GEhmeHnUATG7nbhbkLhTRyspkWt4poq1pwigOymtJNTQ8z6akzJvSNknypK7co-qk6TMNQpZ88JANuoLQeLCUy49Te-yuIrPxZGiV4cOBsgZT3OiIxHaTe9owjANgUVYYgfd7X6LSZMcvzt7UiaySbHbXmA_cPqiSwNjyCMckt9PQpnGwmx9yUy2JrXeVoCMshh-dnpIvc-PTIKcOE1gvuFrTy1wV8rG1t1N-ZJ4-qF5DubWNbtuTj7JHG8s49SU4DqaD7JNrR44I5BVMq14z5iaQsngojLA3VZwC21TP6QpcuPK5LanoZaorPyNiE-7dxSE41O-iWQwLSi2_VF6aSMkjtSq5tkei7ANZZUT1rfDGQS54HuoqxSvkD9z7qKTip4EQQqmQjakZxFIDjuhU7Ue8kcIRbrPm4V3mkNrrNI2ehoomjgJprQN1WJo0q5ILaBTTQZqdskqp6ae03yl3sINpK-Opc6MObuuB23VuQgvWdJjgO2VWMIKYkOk7ql2U9jQjLA5RGm1RjbRWtCNloRu43SGZFpcHD1ThNIGV5ojamqkHifcba9EH_OKjDdqbSniVVGNjVZekfRVfegqYN2qJLDT9VbIkW7rkSlyDbJNSEFLyttxRJXaZFEnmbamjHopVNQcQ1kX7piTZhSULtMoI9VH1r8aOUfOCoVcv-FqCmJ2pjXJnPHaEGRvomrtVey01Ss2QHdLxOIlpaEkfKCzGt9qddtNzRyAOexXbCWA2qscY2FoWTkP6hFMXxO1MvhUz1b41HNQXNRMWZ0sAc9tO7pbLm0XW6SptVwvhWFtCy4snKdkUWUy1ph-pMik_wA26G0G7RZGlz6RGRKVpjai0pDaC5xThUN6C_cEIjjuhP2Y4n0U04Fiu_cLR6o5_i2szBlJynX6rUrze6vWnPbtp4g_aJrhRMQWWPVTjH_hyhznyj1Vsg7XKtLktm1Jm3KfZQTtSJMPOUHkpU8fApj-272CRgFybpvI2YSe6WjNEu7Uo-tPgz5NcThfCtiu1QfRIwyeZ0fc7pzBdbXD0RFeQUOIRGuB5XEbIcpLYzXKez9Q4hz6CK1oCBCWhtuO5RLre7RKKu4BDJaOy5xQXFMSLmQAUBSWlDSbq1Ln0aKo51pKdTfQLrA3CHdFSSCE0oeRdojHtQtkGTVGdQ3CmqlOlyG-QILJNbA4HlQ4lI4uXWhZJrHcVZqFnGscoGXjMwSfHcVs6rcFi4LgJD7rYZvRWl9c8a0W2MPVAe63UrlwEbRaXc6pCmlb7rkOiuSDcyHVZQDs3bujZO8hA7IPP2RRj4Vzn8N9EGVzWY-3Kmbzz12CRzpxqDRws741hNs5bns3od1qdNyNWU9oOxWLlMLiHt2IVMDKdBnRlx2OxTx7gy6r2gFhVkYCwq0Z1NBH1UngqiJOxw4VZBS7xNHs02AtHShuaDsQk0mTN_WysFOaVX9ePWinJYPRI5mECLbsUaa48apJnDclA_XE8BCMJHKnwwRVUiRWWKxz6O-6sOoA_wAtofgtG1WUSLH33GyeoysT-qe8eSMorHuc23j7IzIw0bAKrmVwipDhjLWmuCdlcgqzdgpruppxAFJXqTqxz7ps9ll9amEcIRJ2Wd1CmDvN9FuQfy36LE6bvJXci1swbbHkLTL1hPDT3-YBDe79xWqyCqTjS7ZILrkPxPdckT0D93uKFIdERce6YIBJCWzDqLWDgcp5DFnPOljndyseUl7nFaeW_fSOFmtbYJ91nGnwtJYHKRkBDwe4NrRmbRPskntty0xRl29f0jJGRhsIO4FFPkrzPw_M6OQx_wArt16UbhJc7irlwFqTwq8INDwPRLTNBBTDnIEgtKqx9Ivx7Q_05TbhtsUKyO6Ua3KgeDSI1tIl7Klps7duGykhQCuvsgIAsq_CiqUalJquP-y851qcTZDY28ArYzsgRRkA-Yrzkh1ZOo8grX853th-2XWmh0p4Ge1p9F6FjQH8Ly-O_Rmxu9SvVgUb9d1WXrPG9IZ_G0lWyI-VNfuAj0UuOtm_qpUTpcr6VyBt6P8AmJSc97u9U64eYlJZWzClkWDHnNuKWa3y2mpG8-6HopqzjYpK3m0qWd6T0zfKqRxWN1ULS_TG6JmuXpRYAI4WFjsDSAObW9CdUYtH0_iAd1NLntrcIfiJj3xz2oTwKV3PQn77pLkCcEMjdEO6G_buhVipG6ghUc8hQXkFGy0ngrrVDIqeL2CQFLlQuJBpQwF53RJAGM2SDEznHXus2rffK0Mw28rPad10YeOT9fRmintPcEL1jSfCjPdeXiBfI2hdkL1ZYNAaPRTkMBKoh3shs5LfXhMRDVGl5z4bwR6qVq-EfdcmQ5tdlyrZNZ_JCz8ruE-87uKzp_MSpyGBB7d1VzdqRyN1VrdTioalJGWgvfoaeyflj3-qzc62CjwU9G7BmccuibB4Xo4XcLyOA-sxo916uB2wReqJ3DbjYQHx9wjXbVWt06UuicjHdlZkRLdymS0FWAAalpXIhJE5qXka48LSkASzgAiql2SMZcPcIDw4HdOk05AlFuKRl-VYN3Uhm6I1oCAvGKCplOpiKBsl8ndqCYmWd3FLQRt-Z5TOWNyEtADLIAOFtj45c_8AZrYWOwgyNH0W9G2mNP8A2rMjb4cUTG7Wtljax2XyQptXrSmO4i2oeW22n1CkHSb91MtuB7hKFSlu9VymvdcgtN-TYuSDhdpyR9lyUaLsJU8PAC3lFx4RZtXLNrRY9gUpGm-i0jAXVXCzuoYhkjJaN1rhhe8q7oABxauQbeFheYsyiKLV6rCmDmN33SnVujiS54NnjkeqysbLlx5NL7HsUZT6WPXT2DTtypBsrHxOpNdsStCPJa48qNqsMg0pNEKhNjZVs0mWkPS0hRXupLSuNKa0kDfyqGlUu3XAoNNLgrBSAgnDdBnA0lHc4ALOz8oRtobkplvXbJ6hJRc0cnik_wBJwHNgD5GHdG6T0l2TN-qyNm_ygrbfC9gppFBba1NMJN3ZQRtfMxtVSdldRocNCXjsZNu5AXTyaR9VnVadIdgRwoglLpHRlD122igxv0zMdfeiiJpzwwuTAa0hcmBnOp537rg2zspcxus7d0WNjb4S12e-lSz8KWNpvujFjfRQ1jbOyei5dKMADiEwGCkHQ3WNk3pFBXjE5UtJDY3WVn9LhyATpp3Yhbz2ilQxtrhOwTJ4OfByMRxNGh3Q4s6SJ4sle0yYWPJa5thYPV-m4zN2sIP1U8ZWvLp2J1YOIaStOOVkg5XlRiRNcCNQP1Wt09g23P5Wdx0eOW_Wo8D1S8gR2wtI3v8AK58DPf8AKlfJnlnm5UccJ040d8H8oEkDN-fynocg9TQLJQJc1ke1ockLddW6vqugwIH5LNQcfuqmO0XMGXImyXhkANnutHA6V4EnjZP7h7D0Wq3Dgjb5WAI0MLeN6-quYyIuWwqje0AN012VSzy8prwmeigxt090xtjznRMSlpnl7mhaWVjRl5sH8pZ2NHqGx_Kzs7WXPsgg26_fdaLcaPVwfyl340erg8-qGdp0POkbrkt4Lff8rlWk7f_Z2BhYT6RoZGlnZXN0SUQUZnJhbmRvbVCH8h3VFYF0yipWCw1UVmd7cWVsZW1lbnRJZGVudGlmaWVya2FnZV9vdmVyXzIxbGVsZW1lbnRWYWx1ZfVqaXNzdWVyQXV0aIRDoQEmoRghWQInMIICIzCCAamgAwIBAgIQR29vZ2xlX1Rlc3RfRFNfMTAKBggqhkjOPQQDAzA8MQswCQYDVQQGEwJVUzEOMAwGA1UECBMFVVMtTUExHTAbBgNVBAMMFEdvb2dsZSBURVNUIElBQ0EgbURMMB4XDTIzMDcyNjAwMDAwMVoXDTI0MTAyNTAwMDAwMVowOjELMAkGA1UEBhMCVVMxDjAMBgNVBAgTBVVTLU1BMRswGQYDVQQDDBJHb29nbGUgVEVTVCBEUyBtREwwWTATBgcqhkjOPQIBBggqhkjOPQMBBwNCAAQsgMEL9w9jvdzEHqINdqIuy6Kpf6iBG_GdVyQzsSwMHz-ZTAQ75-F90IOHKBusDDelKTYbPLNqD6w41BrAZvkDo4GOMIGLMB8GA1UdIwQYMBaAFN7zq2033p46gW4QMtArSK81inGrMB0GA1UdDgQWBBQ5e-U8UN_w16LkqeRl6nN6ntiSyDAOBgNVHQ8BAf8EBAMCB4AwIgYDVR0SBBswGYYXaHR0cHM6Ly93d3cuZ29vZ2xlLmNvbS8wFQYDVR0lAQH_BAswCQYHKIGMXQUBAjAKBggqhkjOPQQDAwNoADBlAjEAolzbim8MI5BbnT9YKmCPDBb0NrXu41h9LKl3FnxvFqK53hD-Hd0W3gcuT4ZvBgWnAjBqSIlCH5uzdLi94XWz1qsjIWupfmiVEJdK4PZZoQ6VhGm1vYDfwQWIgx2TGYGmOZhZCibYGFkKIaZndmVyc2lvbmMxLjBvZGlnZXN0QWxnb3JpdGhtZ1NIQS0yNTZnZG9jVHlwZXVvcmcuaXNvLjE4MDEzLjUuMS5tRExsdmFsdWVEaWdlc3RzonFvcmcuaXNvLjE4MDEzLjUuMbgsAlggaQT-k1fFhxgDMCP7IKjDR2j2vg3ckPDzLGZeymEXPasYPlggrZP-aHd7VeR-cVMsYspDIKuaS4GZZ2SF0iaB247OOKoYIlggiouCArIdO_ijRtnXY2dywiXXXAunumP1-3jHnhlKAWIWWCA33RjtD-mjFA__Jd_up-wUN57c1TYLUEI5Esbmdz36nhgqWCDG8ayoPVdUA8djEHcid6g5lFm2fw1R7ZJ9i88h6MOzhRNYIAJRGjWHQDaj7m1QBp6S7dUMbYcf6w_hZJCAvd2TnE30GDFYIEugAZbPazP5g8Il5Vu8vE82ebMlL_MbA3cmjKhVTCevGDVYIHYks_pmqB0iuZLKAf5SsJpe_QAdyP3GJvkJd7ZvaRCqGDNYIGVhZDXW2gYpgG6uuC7C8Dclfgd_CC4TiiwVPveDQDCAElggUDakik6Ekxg6ajwQRln4n6IVKRPnN8Muhmc_FGpSs_AYMFggALEX6uC85DFdSNsRMCjJBY8fbEcl3rTBU2uoJMXK2O8YHFggkyAB2ERXeJqVGTnV5SFUWTg_fQal8imvzQoAS4JxQDYYKFgg__qRCCciwpnJy6nUrQLvpnRuzN1qHXQ5x2ya1k1wOGMYIFggQrn4-MG9O818kPm7DEmX9YuPZ0HpE-xvFgPYDnss2qgOWCCpXaTml_giLFHeOPl-B-h-L_bAVrUm6wJr1_exqtjdRBVYIMy0wJG-brMyci5ffIWtCwxgMab4D0cfivOXTsuyxmJDGDRYIOPQrDaMwwaDA-E848uJJSHHfng-INdqRsYWxWdlXnhJA1ggSs446A5KQAFAK3x8vJOUf5E0nnyI5e0afeu7H2SMIo0YIVgg6XQ3DYVXRjjNMWXb5gIWO3MyKZGN8If_KQJ0H42_MHQYI1ggLFL62zf_V2o4Jvrl7D4vLA1CS0QlvH2A2C29It4g_WsJWCBxN-IenD1sV8uzxuMBmjonrBwNlVXlB9SQghhlmrnc6xBYIDXs4qxjnlwZU4AvuSBTOtHk3QfLMI6Xq3ewpOjj79uNGCVYICZ75FUoH2lWGMHTpaVo6ZXLo2s7haK7ssC93kLRY2fIGBpYIMTKXZoHQciZHxrJcyU6FoPuW6etNz66TEQIVcofycDBCFggf037RpIT1e7yYGJ_motYbfD9Wbn5wi8vYKVcuqpACOgUWCB2lC_P5FlPcev13zVs-bDX8EOyJiEjKBWIvC-RTsOnxwxYIDX4mIjoaRmLG572oLgNwUjm0X37W71uD1FTWzS6423CGClYIH6_e_zz2luuzkc8snY8byyAYSCIuefbdFEYUL_tFvjuGDlYIMlH8XU9Zh7CuOub7xlnj8PVxWKYmStifIG-TuSvbxMVGB9YIOwndeGInGwJmqx7LEgl05no6lsapFNRreBVksh_4dS_GDpYIC2D8iv86wyHAkrlMT4Ll3JYjQSI8xyWr5LiCXZdGRRQGB1YIGXv_cq162jXJxUpndtiMc2qmUellMIz3MGGSE9FKPPDAFggekQkIbFyl5i1zthc9dGzONLLFlQD1W9Pjq_tHIfYwA4BWCCfG21UmkxLknz-xYbXC_idPPYw2Sb4dcFlMm1rQB6OHRgnWCA_b-gvNaXxbr76CtL_FkirVATAkiuXaHKZ-PvlZPKAyRg8WCAruQbupO6UT2rdmTMYCTbmrVPwXjGDpISMxkKj21DjRBgYWCCXQbi0ERVvMgxnm1UL-Xb4ZN600Cy081sIwASxLBDIrxgsWCCzen4DuBXnXOyiNhSH1MAVNJfz_5NLXUiTmgm8Eizhbhg9WCD1eUWr2DdFhHQ12fj8kv-LZyKW0LVs8oIp_79eaYTanRgZWCAZZQinngkVESyMgD4pKeKvUk_qkBiJE5g2smuTYkXz5RgtWCB_nbM0LepireZ0c50nSVvK1VYo-lNw3vu54PTLWg1atgdYIHUAMsbHFojdOv2wnAq3DR3emGV1lyRsxW-NTCvLR-ZHGB5YIKoOtGz_TdD1ecISdBpYyKsp2VZ3vFMEuERj0aA_XcZsGCZYIHrsukVitUDG4Dt5hjMHMoHnKHQ4c_3YRpT5fXe-Z1dAd29yZy5pc28uMTgwMTMuNS4xLmFhbXZhsw1YIJhzD0M_22JJAtQGVelHV0PQKd9W6N1_HIFxLJNswQpqBFggJVArScEQw50EqOL0sUmzk0bPa7tQ4Uy00hkWKodkfyQFWCDKyBuH3NPN5QIBVPzSzz8MKXCdKWlJ59FnREwa8QTqdBgvWCCwLOa7dH6zON9XP3vAJyq3CJTzL-990IfIgH2yYaOy4hg2WCA--FRsDZFlSXRMoRlqXueLrW0upyFxXQ9QLo5-mDY2XwpYINGXcigfotgh1qyqu5x9wkVkyRzSShFN1NBTUgRsQgkjGCRYIMI4n1_AkDa4xf9hzcfncTzEsrvgxh1HIVhI9CjbSuoPGC5YIAigSzweW-RL5jo4BvJVJgOrzO9Bmg7BLz6Kga8kdn1tGBtYIKTULrs4QH4V3N7dx2XAJnYiFHA_235JI5bLm2laJw2tGDJYINhJUSyfcE7QaQk9ex0q5rTODwEBa117eRGzFvUXz0LFEVgg-2OWuS16Y7qboyp3DW52ATlk7qAcL-gON3CZgmHKzd4XWCA1CQn83ipsPT6dljnUvrVVPPyv3hfc8bdny_7aUbyilxg4WCDKYuVf50OyYQt5QVsWFlTgqn0pt6jYHcgalJJ0Ylt1Xhg7WCDfY8S42FlYl_tBYALgLgCUau-qHtJjNXdMwvyMLSaJHxg3WCCgr48fWImcr1Tt04zI72MVLZQ-cLkR1BYmeQVmELD7AgZYIKznnYDksYVQneTtKxHegzkDJYrcfHWvGthrTn07TqwnGCtYIBissp01k_rk6vjtEGmg4JPQ3EelUWbL9XxwwrqC_sNfC1ggq7_9tOBo0sOIeKZzs7hrSWiJC-SsibswA7Pw0cFnajQPWCDXLTePyJi-xMm4LZRYCFa4ANdWtBJF8H39-PhviHwAeG1kZXZpY2VLZXlJbmZvoWlkZXZpY2VLZXmkAQIgASFYIPLIzqoFL93dXwCx7kBUpXzrxu1mbatkPM-09fyLsmnmIlgg9e5kZWrqMGE0vUfzxfpVO_TzI5Av1lzaMKzQDW0mxSRsdmFsaWRpdHlJbmZvo2ZzaWduZWTAeBgyMDI0LTA4LTI3VDEzOjUyOjQ2Ljc5MlppdmFsaWRGcm9twHgYMjAyNC0wOC0yN1QxMzo1Mjo0Ni43OTJaanZhbGlkVW50aWzAeBgyMDI0LTA5LTI2VDEzOjUyOjQ2Ljc5MlpYQMtKtL5G4HeC8LPdVtoeS60N33HA89Jz5EnytWx2Lh4q1XXq_EfNWDivgBN4MthGoIpee9djMTOsrMHcI6HgicZsZGV2aWNlU2lnbmVkompuYW1lU3BhY2Vz2BhBoGpkZXZpY2VBdXRooW9kZXZpY2VTaWduYXR1cmWEQ6EBJqBY59gYWOOEdERldmljZUF1dGhlbnRpY2F0aW9ug_b2hHFCcm93c2VySGFuZG92ZXJ2MVgg7PS5izuMXIi1ZTmFN60EKyvwSMJz-dpzICkDvRhz-tBYV6NjY2F0AWR0eXBlAWdkZXRhaWxzoWdiYXNlVXJseDhodHRwczovL3Jldmlldy1hcHAtZGV2LWJyYW5jaC0zLmNlcnRpZmljYXRpb24ub3BlbmlkLm5ldFgg3iOcNKp9tMxyKcQ8-6yM5LTAyK9L8oaLvAyFLNQsWo11b3JnLmlzby4xODAxMy41LjEubURM2BhBoFhAtetNNWeCNibSxy0DlV8jLGpYw-i_cRFrEDR1tsdr4JZLvPwwrDekE0J8R8gZ7gVW5Ee-SLo96WVSGREdO6sJqmZzdGF0dXMA\\\"\\n}\",\"protocol\":\"openid4vp\"}";

	}

	@Test
	public void testEvaluate_goodResponse() {

		env.putString("incoming_request", "body", goodResponse);

		cond.execute(env);

		assertThat(env.getObject("authorization_endpoint_response")).isNotNull();
	}

}
